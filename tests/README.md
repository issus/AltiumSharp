# Tests

This directory contains all test projects for the OriginalCircuit.Altium library.

## Running Tests

Run the full test suite:

```
dotnet test
```

Run tests for a specific project:

```
dotnet test tests/OriginalCircuit.Altium.Tests
```

Run with verbose output:

```
dotnet test --logger "console;verbosity=detailed"
```

Run a specific test by name:

```
dotnet test --filter "FullyQualifiedName~CoordTests"
```

## Test Projects

### OriginalCircuit.Altium.Tests

The main test project. Contains:

- **Unit tests** — isolated tests for coordinate arithmetic, parameter parsing, binary format helpers, and individual record types
- **Integration tests** — read real Altium files from `TestData/` and assert on their contents
- **Round-trip tests** — read a file, write it back to a memory stream, read again, and compare the result
- **Property coverage tests** (`PropertyCoverage/`) — verify that all public properties on each model type are exercised by at least one test; auto-generates `COVERAGE.md`

Key test classes:

| Class | What it tests |
|-------|--------------|
| `CoordTests` | Fixed-point coordinate arithmetic and unit conversions |
| `CoordGeometryTests` | `CoordPoint` and `CoordRect` geometry operations |
| `ParameterParserTests` | Pipe-delimited parameter string parsing and serialization |
| `BinaryFormatReaderTests` | Pascal strings, C-strings, zlib decompression, round-trips |
| `DiagnosticTests` | Error collection and `AltiumDiagnostic` severity levels |
| `AltiumLibraryTests` | Full read/write round-trips for all four file formats |
| `SchPropertyCoverageTests` | Property coverage for schematic model types |
| `PcbPropertyCoverageTests` | Property coverage for PCB model types |

### OriginalCircuit.Altium.Benchmarks

Performance benchmarks using [BenchmarkDotNet](https://benchmarkdotnet.org/). Measures throughput for reading, writing, and rendering large files.

Run benchmarks in Release mode:

```
dotnet run --project tests/OriginalCircuit.Altium.Benchmarks -c Release
```

## TestData Directory

Integration and round-trip tests depend on Altium files in `TestData/` at the repository root. This directory contains:

- Sample `.SchLib`, `.PcbLib`, `.SchDoc`, and `.PcbDoc` files
- JSON snapshots generated by the `TestDataGenerator/` Altium scripting project, used to validate that reader output matches what Altium itself reports

The `TestData/` directory is not included in the NuGet package.

## Coverage Report

`COVERAGE.md` in this directory is auto-generated by `CoverageReportTests`. It lists every public property on each model type alongside its coverage status. Regenerate it by running the tests — the file is updated in place.
